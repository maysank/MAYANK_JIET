<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  </head>
  <body>
    Controler&gt;<a href="http://admincontroller.js">admincontroller.js</a
    ><br /><br />const mongoose = require("mongoose");<br />const JWT =
    require("jsonwebtoken");<br />const Admin = require("../Model/admin");<br /><br /><a
      href="http://exports.signup"
      >exports.signup</aF>
    = (req,res) =&gt; {<br />&nbsp;&nbsp;&nbsp; let {firstName,lastName,email,
    password} = <a href="http://req.body">req.body</a>;<br />&nbsp;&nbsp;&nbsp;
    let admin = new Admin({<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    firstName,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lastName,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    email,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; password,<br />&nbsp;&nbsp;&nbsp;
    });<br />&nbsp;&nbsp;&nbsp;
    <a href="http://admin.save">admin.save</a>()<br />&nbsp;&nbsp;&nbsp;
    .then(() =&gt; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
    <a href="http://res.status">res.status</a>(<a href="tel:200">200</a
    >).send(admin);<br />&nbsp;&nbsp;&nbsp; })<br />&nbsp;&nbsp;&nbsp;
    .catch((error) =&gt; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <a href="http://console.error">console.error</a
    >(error);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
    <a href="http://res.status">res.status</a>(<a href="tel:500">500</a
    >).send("ERROR");<br />&nbsp;&nbsp;&nbsp; });<br />};<br /><br /><a
      href="http://exports.login"
      >exports.login</a
    >
    = (req,res) =&gt; {<br />&nbsp;&nbsp;&nbsp; let {email, password} =
    <a href="http://req.body">req.body</a>;<br />&nbsp;&nbsp;&nbsp;
    <a href="http://Admin.findOne">Admin.findOne</a>({email : email})<br />&nbsp;&nbsp;&nbsp;
    .then((admin) =&gt; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <a href="http://console.info">console.info</a>(`User with email ${email} was
    successfully found`);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    if(password ==
    <a href="http://admin.password">admin.password</a
    >){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    const token =
    <a href="http://JWT.sign">JWT.sign</a
    >({<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    email :
    <a href="http://admin.email">admin.email</a
    >,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    },<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    "AdminKey",<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    expiresIn : "1h",<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    );<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <a href="http://console.info">console.info</a>("LOgin successful");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    return <a href="http://res.status">res.status</a>(<a href="tel:200">200</a
    >).send({admin, token});<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <a href="http://console.warn">console.warn</a>("Password incorrect");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    return <a href="http://res.status">res.status</a>(<a href="tel:401">401</a
    >).send("Password was Incorrect");<br />&nbsp;&nbsp;&nbsp; })<br />&nbsp;&nbsp;&nbsp;
    .catch((error) =&gt; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <a href="http://console.error">console.error</a>(`User with email ${email}
    does not exist`);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return
    <a href="http://res.status">res.status</a>(<a href="tel:404">404</a
    >).send(`User with email ${email} doesn't exist.`);<br />&nbsp;&nbsp;&nbsp;
    });<br />};
  </body>
</html>
